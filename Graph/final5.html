<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network Graph with Filters</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        #control-panel {
            margin-bottom: 10px;
        }
        .control-button {
            margin-right: 10px;
        }
        .dependency-node rect {
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="control-panel">
        <label for="level-select">Filter by Level:</label>
        <select id="level-select" class="control-button">
            <option value="">All Levels</option>
        </select>
        <label for="cluster-select">Filter by Cluster:</label>
        <select id="cluster-select" class="control-button">
            <option value="">All Clusters</option>
        </select>
        <button id="reset-filters" class="control-button">Reset Filters</button>
    </div>
    <svg id="graph" width="800" height="600"></svg>
    <script>
        // Sample data
        const graphData = {
    "nodes": [
        {
            "id": "dbo.ErrorLog.USER_TABLE",
            "schema_name": "dbo",
            "object_name": "ErrorLog",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 3,
            "in_degree": 0,
            "out_degree": 1
        },
        {
            "id": "dbo.uspLogError.SQL_STORED_PROCEDURE",
            "schema_name": "dbo",
            "object_name": "uspLogError",
            "object_type": "SQL_STORED_PROCEDURE",
            "level": 2,
            "cluster": 3,
            "in_degree": 2,
            "out_degree": 11
        },
        {
            "id": "dbo.ufnGetAccountingEndDate.SQL_SCALAR_FUNCTION",
            "schema_name": "dbo",
            "object_name": "ufnGetAccountingEndDate",
            "object_type": "SQL_SCALAR_FUNCTION",
            "level": 1,
            "cluster": 4,
            "in_degree": 0,
            "out_degree": 1
        },
        {
            "id": "Sales.uSalesOrderHeader.SQL_TRIGGER",
            "schema_name": "Sales",
            "object_name": "uSalesOrderHeader",
            "object_type": "SQL_TRIGGER",
            "level": 3,
            "cluster": 4,
            "in_degree": 7,
            "out_degree": 0
        },
        {
            "id": "dbo.ufnGetAccountingStartDate.SQL_SCALAR_FUNCTION",
            "schema_name": "dbo",
            "object_name": "ufnGetAccountingStartDate",
            "object_type": "SQL_SCALAR_FUNCTION",
            "level": 1,
            "cluster": 4,
            "in_degree": 0,
            "out_degree": 1
        },
        {
            "id": "dbo.ufnLeadingZeros.SQL_SCALAR_FUNCTION",
            "schema_name": "dbo",
            "object_name": "ufnLeadingZeros",
            "object_type": "SQL_SCALAR_FUNCTION",
            "level": 1,
            "cluster": 0,
            "in_degree": 0,
            "out_degree": 1
        },
        {
            "id": "Sales.Customer.USER_TABLE",
            "schema_name": "Sales",
            "object_name": "Customer",
            "object_type": "USER_TABLE",
            "level": 2,
            "cluster": 0,
            "in_degree": 1,
            "out_degree": 3
        },
        {
            "id": "HumanResources.uspUpdateEmployeeHireInfo.SQL_STORED_PROCEDURE",
            "schema_name": "HumanResources",
            "object_name": "uspUpdateEmployeeHireInfo",
            "object_type": "SQL_STORED_PROCEDURE",
            "level": 3,
            "cluster": 1,
            "in_degree": 3,
            "out_degree": 0
        },
        {
            "id": "HumanResources.uspUpdateEmployeeLogin.SQL_STORED_PROCEDURE",
            "schema_name": "HumanResources",
            "object_name": "uspUpdateEmployeeLogin",
            "object_type": "SQL_STORED_PROCEDURE",
            "level": 3,
            "cluster": 1,
                "in_degree": 2,
                "out_degree": 0
        },
        {
            "id": "HumanResources.uspUpdateEmployeePersonalInfo.SQL_STORED_PROCEDURE",
            "schema_name": "HumanResources",
            "object_name": "uspUpdateEmployeePersonalInfo",
            "object_type": "SQL_STORED_PROCEDURE",
            "level": 3,
            "cluster": 1,
            "in_degree": 2,
            "out_degree": 0
        },
        {
            "id": "Production.iWorkOrder.SQL_TRIGGER",
            "schema_name": "Production",
            "object_name": "iWorkOrder",
            "object_type": "SQL_TRIGGER",
            "level": 3,
            "cluster": 3,
            "in_degree": 3,
            "out_degree": 0
        },
        {
            "id": "Production.uWorkOrder.SQL_TRIGGER",
            "schema_name": "Production",
            "object_name": "uWorkOrder",
            "object_type": "SQL_TRIGGER",
            "level": 3,
            "cluster": 3,
            "in_degree": 3,
            "out_degree": 0
        },
        {
            "id": "Purchasing.dVendor.SQL_TRIGGER",
            "schema_name": "Purchasing",
            "object_name": "dVendor",
            "object_type": "SQL_TRIGGER",
            "level": 3,
            "cluster": 3,
            "in_degree": 2,
            "out_degree": 0
        },
        {
            "id": "Purchasing.iPurchaseOrderDetail.SQL_TRIGGER",
            "schema_name": "Purchasing",
            "object_name": "iPurchaseOrderDetail",
            "object_type": "SQL_TRIGGER",
            "level": 3,
            "cluster": 3,
            "in_degree": 5,
            "out_degree": 0
        },
        {
            "id": "Purchasing.uPurchaseOrderDetail.SQL_TRIGGER",
            "schema_name": "Purchasing",
            "object_name": "uPurchaseOrderDetail",
            "object_type": "SQL_TRIGGER",
            "level": 3,
            "cluster": 3,
            "in_degree": 5,
            "out_degree": 0
        },
        {
            "id": "Purchasing.uPurchaseOrderHeader.SQL_TRIGGER",
            "schema_name": "Purchasing",
            "object_name": "uPurchaseOrderHeader",
            "object_type": "SQL_TRIGGER",
            "level": 3,
            "cluster": 3,
            "in_degree": 3,
            "out_degree": 0
        },
        {
            "id": "Sales.iduSalesOrderDetail.SQL_TRIGGER",
            "schema_name": "Sales",
            "object_name": "iduSalesOrderDetail",
            "object_type": "SQL_TRIGGER",
            "level": 3,
            "cluster": 3,
            "in_degree": 7,
            "out_degree": 0
        },
        {
            "id": "dbo.uspPrintError.SQL_STORED_PROCEDURE",
            "schema_name": "dbo",
            "object_name": "uspPrintError",
            "object_type": "SQL_STORED_PROCEDURE",
            "level": 1,
            "cluster": 3,
            "in_degree": 0,
            "out_degree": 9
        },
        {
            "id": "HumanResources.Department.USER_TABLE",
            "schema_name": "HumanResources",
            "object_name": "Department",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 1,
            "in_degree": 0,
            "out_degree": 2
        },
        {
            "id": "HumanResources.vEmployeeDepartment.VIEW",
            "schema_name": "HumanResources",
            "object_name": "vEmployeeDepartment",
            "object_type": "VIEW",
            "level": 2,
            "cluster": 1,
            "in_degree": 4,
            "out_degree": 0
        },
        {
            "id": "HumanResources.vEmployeeDepartmentHistory.VIEW",
            "schema_name": "HumanResources",
            "object_name": "vEmployeeDepartmentHistory",
            "object_type": "VIEW",
            "level": 2,
            "cluster": 1,
            "in_degree": 5,
            "out_degree": 0
        },
        {
            "id": "HumanResources.Employee.USER_TABLE",
            "schema_name": "HumanResources",
            "object_name": "Employee",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 1,
            "in_degree": 0,
            "out_degree": 11
        },
        {
            "id": "dbo.ufnGetContactInformation.SQL_TABLE_VALUED_FUNCTION",
            "schema_name": "dbo",
            "object_name": "ufnGetContactInformation",
            "object_type": "SQL_TABLE_VALUED_FUNCTION",
            "level": 3,
            "cluster": 0,
            "in_degree": 7,
            "out_degree": 0
        },
        {
            "id": "dbo.uspGetEmployeeManagers.SQL_STORED_PROCEDURE",
            "schema_name": "dbo",
            "object_name": "uspGetEmployeeManagers",
            "object_type": "SQL_STORED_PROCEDURE",
            "level": 2,
            "cluster": 1,
            "in_degree": 2,
            "out_degree": 0
        },
        {
            "id": "dbo.uspGetManagerEmployees.SQL_STORED_PROCEDURE",
            "schema_name": "dbo",
            "object_name": "uspGetManagerEmployees",
            "object_type": "SQL_STORED_PROCEDURE",
            "level": 2,
            "cluster": 1,
            "in_degree": 2,
            "out_degree": 0
        },
        {
            "id": "HumanResources.vEmployee.VIEW",
            "schema_name": "HumanResources",
            "object_name": "vEmployee",
            "object_type": "VIEW",
            "level": 2,
            "cluster": 0,
            "in_degree": 9,
            "out_degree": 0
        },
        {
            "id": "Sales.vSalesPerson.VIEW",
            "schema_name": "Sales",
            "object_name": "vSalesPerson",
            "object_type": "VIEW",
            "level": 2,
            "cluster": 0,
            "in_degree": 11,
            "out_degree": 0
        },
        {
            "id": "Sales.vSalesPersonSalesByFiscalYears.VIEW",
            "schema_name": "Sales",
            "object_name": "vSalesPersonSalesByFiscalYears",
            "object_type": "VIEW",
            "level": 2,
            "cluster": 4,
            "in_degree": 5,
            "out_degree": 0
        },
        {
            "id": "HumanResources.EmployeeDepartmentHistory.USER_TABLE",
            "schema_name": "HumanResources",
            "object_name": "EmployeeDepartmentHistory",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 1,
            "in_degree": 0,
            "out_degree": 2
        },
        {
            "id": "HumanResources.EmployeePayHistory.USER_TABLE",
            "schema_name": "HumanResources",
            "object_name": "EmployeePayHistory",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 1,
            "in_degree": 0,
            "out_degree": 1
        },
        {
            "id": "HumanResources.JobCandidate.USER_TABLE",
            "schema_name": "HumanResources",
            "object_name": "JobCandidate",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 5,
            "in_degree": 0,
            "out_degree": 3
        },
        {
            "id": "HumanResources.vJobCandidate.VIEW",
            "schema_name": "HumanResources",
            "object_name": "vJobCandidate",
            "object_type": "VIEW",
            "level": 2,
            "cluster": 5,
            "in_degree": 1,
            "out_degree": 0
        },
        {
            "id": "HumanResources.vJobCandidateEducation.VIEW",
            "schema_name": "HumanResources",
            "object_name": "vJobCandidateEducation",
            "object_type": "VIEW",
            "level": 2,
            "cluster": 5,
            "in_degree": 1,
            "out_degree": 0
        },
        {
            "id": "HumanResources.vJobCandidateEmployment.VIEW",
            "schema_name": "HumanResources",
            "object_name": "vJobCandidateEmployment",
            "object_type": "VIEW",
            "level": 2,
            "cluster": 5,
            "in_degree": 1,
            "out_degree": 0
        },
        {
            "id": "HumanResources.Shift.USER_TABLE",
            "schema_name": "HumanResources",
            "object_name": "Shift",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 1,
            "in_degree": 0,
            "out_degree": 1
        },
        {
            "id": "Person.Address.USER_TABLE",
            "schema_name": "Person",
            "object_name": "Address",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 0,
            "in_degree": 0,
            "out_degree": 5
        },
        {
            "id": "Purchasing.vVendorWithAddresses.VIEW",
            "schema_name": "Purchasing",
            "object_name": "vVendorWithAddresses",
            "object_type": "VIEW",
            "level": 2,
            "cluster": 0,
            "in_degree": 6,
            "out_degree": 0
        },
        {
            "id": "Sales.vIndividualCustomer.VIEW",
            "schema_name": "Sales",
            "object_name": "vIndividualCustomer",
            "object_type": "VIEW",
            "level": 3,
            "cluster": 0,
            "in_degree": 10,
            "out_degree": 0
        },
        {
            "id": "Sales.vStoreWithAddresses.VIEW",
            "schema_name": "Sales",
            "object_name": "vStoreWithAddresses",
            "object_type": "VIEW",
            "level": 2,
            "cluster": 0,
            "in_degree": 6,
            "out_degree": 0
        },
        {
            "id": "Person.AddressType.USER_TABLE",
            "schema_name": "Person",
            "object_name": "AddressType",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 0,
            "in_degree": 0,
            "out_degree": 3
        },
        {
            "id": "Person.BusinessEntityAddress.USER_TABLE",
            "schema_name": "Person",
            "object_name": "BusinessEntityAddress",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 0,
            "in_degree": 0,
            "out_degree": 5
        },
        {
            "id": "Person.BusinessEntityContact.USER_TABLE",
            "schema_name": "Person",
            "object_name": "BusinessEntityContact",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 0,
            "in_degree": 0,
            "out_degree": 3
        },
        {
            "id": "Purchasing.vVendorWithContacts.VIEW",
            "schema_name": "Purchasing",
            "object_name": "vVendorWithContacts",
            "object_type": "VIEW",
            "level": 2,
            "cluster": 0,
            "in_degree": 7,
            "out_degree": 0
        },
        {
            "id": "Sales.vStoreWithContacts.VIEW",
            "schema_name": "Sales",
            "object_name": "vStoreWithContacts",
            "object_type": "VIEW",
            "level": 2,
            "cluster": 0,
            "in_degree": 7,
            "out_degree": 0
        },
        {
            "id": "Person.ContactType.USER_TABLE",
            "schema_name": "Person",
            "object_name": "ContactType",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 0,
            "in_degree": 0,
            "out_degree": 3
        },
        {
            "id": "Person.CountryRegion.USER_TABLE",
            "schema_name": "Person",
            "object_name": "CountryRegion",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 0,
            "in_degree": 0,
            "out_degree": 6
        },
        {
            "id": "Person.vStateProvinceCountryRegion.VIEW",
            "schema_name": "Person",
            "object_name": "vStateProvinceCountryRegion",
            "object_type": "VIEW",
            "level": 2,
            "cluster": 0,
            "in_degree": 2,
            "out_degree": 0
        },
        {
            "id": "Person.EmailAddress.USER_TABLE",
            "schema_name": "Person",
            "object_name": "EmailAddress",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 0,
            "in_degree": 0,
            "out_degree": 5
        },
        {
            "id": "Person.Person.USER_TABLE",
            "schema_name": "Person",
            "object_name": "Person",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 1,
            "in_degree": 0,
            "out_degree": 15
        },
        {
            "id": "Person.iuPerson.SQL_TRIGGER",
            "schema_name": "Person",
            "object_name": "iuPerson",
            "object_type": "SQL_TRIGGER",
            "level": 2,
            "cluster": 1,
            "in_degree": 1,
            "out_degree": 0
        },
        {
            "id": "Person.vAdditionalContactInfo.VIEW",
            "schema_name": "Person",
            "object_name": "vAdditionalContactInfo",
            "object_type": "VIEW",
            "level": 2,
            "cluster": 1,
            "in_degree": 1,
            "out_degree": 0
        },
        {
            "id": "Sales.vPersonDemographics.VIEW",
            "schema_name": "Sales",
            "object_name": "vPersonDemographics",
            "object_type": "VIEW",
            "level": 2,
            "cluster": 1,
            "in_degree": 1,
            "out_degree": 0
        },
        {
            "id": "Person.PersonPhone.USER_TABLE",
            "schema_name": "Person",
            "object_name": "PersonPhone",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 0,
            "in_degree": 0,
            "out_degree": 5
        },
        {
            "id": "Person.PhoneNumberType.USER_TABLE",
            "schema_name": "Person",
            "object_name": "PhoneNumberType",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 0,
            "in_degree": 0,
            "out_degree": 5
        },
        {
            "id": "Person.StateProvince.USER_TABLE",
            "schema_name": "Person",
            "object_name": "StateProvince",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 0,
            "in_degree": 0,
            "out_degree": 6
        },
        {
            "id": "Production.BillOfMaterials.USER_TABLE",
            "schema_name": "Production",
            "object_name": "BillOfMaterials",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 2,
            "in_degree": 0,
            "out_degree": 2
        },
        {
            "id": "dbo.uspGetBillOfMaterials.SQL_STORED_PROCEDURE",
            "schema_name": "dbo",
            "object_name": "uspGetBillOfMaterials",
            "object_type": "SQL_STORED_PROCEDURE",
            "level": 2,
            "cluster": 2,
            "in_degree": 2,
            "out_degree": 0
        },
        {
            "id": "dbo.uspGetWhereUsedProductID.SQL_STORED_PROCEDURE",
            "schema_name": "dbo",
            "object_name": "uspGetWhereUsedProductID",
            "object_type": "SQL_STORED_PROCEDURE",
            "level": 2,
            "cluster": 2,
            "in_degree": 2,
            "out_degree": 0
        },
        {
            "id": "Production.Document.USER_TABLE",
            "schema_name": "Production",
            "object_name": "Document",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 7,
            "in_degree": 0,
            "out_degree": 0
        },
        {
            "id": "Production.Product.USER_TABLE",
            "schema_name": "Production",
            "object_name": "Product",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 2,
            "in_degree": 0,
            "out_degree": 6
        },
        {
            "id": "dbo.ufnGetProductDealerPrice.SQL_SCALAR_FUNCTION",
            "schema_name": "dbo",
            "object_name": "ufnGetProductDealerPrice",
            "object_type": "SQL_SCALAR_FUNCTION",
            "level": 2,
            "cluster": 2,
            "in_degree": 2,
            "out_degree": 0
        },
        {
            "id": "dbo.ufnGetProductListPrice.SQL_SCALAR_FUNCTION",
            "schema_name": "dbo",
            "object_name": "ufnGetProductListPrice",
            "object_type": "SQL_SCALAR_FUNCTION",
            "level": 2,
            "cluster": 2,
            "in_degree": 2,
            "out_degree": 0
        },
        {
            "id": "dbo.ufnGetProductStandardCost.SQL_SCALAR_FUNCTION",
            "schema_name": "dbo",
            "object_name": "ufnGetProductStandardCost",
            "object_type": "SQL_SCALAR_FUNCTION",
            "level": 2,
            "cluster": 2,
            "in_degree": 2,
            "out_degree": 0
        },
        {
            "id": "Production.vProductAndDescription.VIEW",
            "schema_name": "Production",
            "object_name": "vProductAndDescription",
            "object_type": "VIEW",
            "level": 2,
            "cluster": 2,
            "in_degree": 4,
            "out_degree": 0
        },
        {
            "id": "Production.ProductCostHistory.USER_TABLE",
            "schema_name": "Production",
            "object_name": "ProductCostHistory",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 2,
            "in_degree": 0,
            "out_degree": 1
        },
        {
            "id": "Production.ProductDescription.USER_TABLE",
            "schema_name": "Production",
            "object_name": "ProductDescription",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 2,
            "in_degree": 0,
            "out_degree": 1
        },
        {
            "id": "Production.ProductInventory.USER_TABLE",
            "schema_name": "Production",
            "object_name": "ProductInventory",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 6,
            "in_degree": 0,
            "out_degree": 1
        },
        {
            "id": "dbo.ufnGetStock.SQL_SCALAR_FUNCTION",
            "schema_name": "dbo",
            "object_name": "ufnGetStock",
            "object_type": "SQL_SCALAR_FUNCTION",
            "level": 2,
            "cluster": 6,
            "in_degree": 1,
            "out_degree": 0
        },
        {
            "id": "Production.ProductListPriceHistory.USER_TABLE",
            "schema_name": "Production",
            "object_name": "ProductListPriceHistory",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 2,
            "in_degree": 0,
            "out_degree": 2
        },
        {
            "id": "Production.ProductModel.USER_TABLE",
            "schema_name": "Production",
            "object_name": "ProductModel",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 2,
            "in_degree": 0,
            "out_degree": 3
        },
        {
            "id": "Production.vProductModelCatalogDescription.VIEW",
            "schema_name": "Production",
            "object_name": "vProductModelCatalogDescription",
            "object_type": "VIEW",
            "level": 2,
            "cluster": 2,
            "in_degree": 1,
            "out_degree": 0
        },
        {
            "id": "Production.vProductModelInstructions.VIEW",
            "schema_name": "Production",
            "object_name": "vProductModelInstructions",
            "object_type": "VIEW",
            "level": 2,
            "cluster": 2,
            "in_degree": 1,
            "out_degree": 0
        },
        {
            "id": "Production.ProductModelProductDescriptionCulture.USER_TABLE",
            "schema_name": "Production",
            "object_name": "ProductModelProductDescriptionCulture",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 2,
            "in_degree": 0,
            "out_degree": 1
        },
        {
            "id": "Production.TransactionHistory.USER_TABLE",
            "schema_name": "Production",
            "object_name": "TransactionHistory",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 3,
            "in_degree": 0,
            "out_degree": 5
        },
        {
            "id": "Production.WorkOrder.USER_TABLE",
            "schema_name": "Production",
            "object_name": "WorkOrder",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 8,
            "in_degree": 0,
            "out_degree": 0
        },
        {
            "id": "Purchasing.PurchaseOrderDetail.USER_TABLE",
            "schema_name": "Purchasing",
            "object_name": "PurchaseOrderDetail",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 3,
            "in_degree": 0,
            "out_degree": 2
        },
        {
            "id": "Purchasing.PurchaseOrderHeader.USER_TABLE",
            "schema_name": "Purchasing",
            "object_name": "PurchaseOrderHeader",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 3,
            "in_degree": 0,
            "out_degree": 3
        },
        {
            "id": "Purchasing.Vendor.USER_TABLE",
            "schema_name": "Purchasing",
            "object_name": "Vendor",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 0,
            "in_degree": 0,
            "out_degree": 3
        },
        {
            "id": "Sales.SalesOrderDetail.USER_TABLE",
            "schema_name": "Sales",
            "object_name": "SalesOrderDetail",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 3,
            "in_degree": 0,
            "out_degree": 1
        },
        {
            "id": "Sales.SalesOrderHeader.USER_TABLE",
            "schema_name": "Sales",
            "object_name": "SalesOrderHeader",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 4,
            "in_degree": 0,
            "out_degree": 3
        },
        {
            "id": "Sales.SalesPerson.USER_TABLE",
            "schema_name": "Sales",
            "object_name": "SalesPerson",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 4,
            "in_degree": 0,
            "out_degree": 3
        },
        {
            "id": "Sales.SalesTerritory.USER_TABLE",
            "schema_name": "Sales",
            "object_name": "SalesTerritory",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 4,
            "in_degree": 0,
            "out_degree": 3
        },
        {
            "id": "Sales.Store.USER_TABLE",
            "schema_name": "Sales",
            "object_name": "Store",
            "object_type": "USER_TABLE",
            "level": 1,
            "cluster": 0,
            "in_degree": 0,
            "out_degree": 4
        },
        {
            "id": "Sales.vStoreWithDemographics.VIEW",
            "schema_name": "Sales",
            "object_name": "vStoreWithDemographics",
            "object_type": "VIEW",
            "level": 2,
            "cluster": 0,
            "in_degree": 1,
            "out_degree": 0
        }
    ],
    "edges": [
        {
            "source": "dbo.ErrorLog.USER_TABLE",
            "target": "dbo.uspLogError.SQL_STORED_PROCEDURE"
        },
        {
            "source": "dbo.uspLogError.SQL_STORED_PROCEDURE",
            "target": "HumanResources.uspUpdateEmployeeHireInfo.SQL_STORED_PROCEDURE"
        },
        {
            "source": "dbo.uspLogError.SQL_STORED_PROCEDURE",
            "target": "HumanResources.uspUpdateEmployeeLogin.SQL_STORED_PROCEDURE"
        },
        {
            "source": "dbo.uspLogError.SQL_STORED_PROCEDURE",
            "target": "HumanResources.uspUpdateEmployeePersonalInfo.SQL_STORED_PROCEDURE"
        },
        {
            "source": "dbo.uspLogError.SQL_STORED_PROCEDURE",
            "target": "Production.iWorkOrder.SQL_TRIGGER"
        },
        {
            "source": "dbo.uspLogError.SQL_STORED_PROCEDURE",
            "target": "Production.uWorkOrder.SQL_TRIGGER"
        },
        {
            "source": "dbo.uspLogError.SQL_STORED_PROCEDURE",
            "target": "Purchasing.dVendor.SQL_TRIGGER"
        },
        {
            "source": "dbo.uspLogError.SQL_STORED_PROCEDURE",
            "target": "Purchasing.iPurchaseOrderDetail.SQL_TRIGGER"
        },
        {
            "source": "dbo.uspLogError.SQL_STORED_PROCEDURE",
            "target": "Purchasing.uPurchaseOrderDetail.SQL_TRIGGER"
        },
        {
            "source": "dbo.uspLogError.SQL_STORED_PROCEDURE",
            "target": "Purchasing.uPurchaseOrderHeader.SQL_TRIGGER"
        },
        {
            "source": "dbo.uspLogError.SQL_STORED_PROCEDURE",
            "target": "Sales.iduSalesOrderDetail.SQL_TRIGGER"
        },
        {
            "source": "dbo.uspLogError.SQL_STORED_PROCEDURE",
            "target": "Sales.uSalesOrderHeader.SQL_TRIGGER"
        },
        {
            "source": "dbo.ufnGetAccountingEndDate.SQL_SCALAR_FUNCTION",
            "target": "Sales.uSalesOrderHeader.SQL_TRIGGER"
        },
        {
            "source": "dbo.ufnGetAccountingStartDate.SQL_SCALAR_FUNCTION",
            "target": "Sales.uSalesOrderHeader.SQL_TRIGGER"
        },
        {
            "source": "dbo.ufnLeadingZeros.SQL_SCALAR_FUNCTION",
            "target": "Sales.Customer.USER_TABLE"
        },
        {
            "source": "Sales.Customer.USER_TABLE",
            "target": "dbo.ufnGetContactInformation.SQL_TABLE_VALUED_FUNCTION"
        },
        {
            "source": "Sales.Customer.USER_TABLE",
            "target": "Sales.iduSalesOrderDetail.SQL_TRIGGER"
        },
        {
            "source": "Sales.Customer.USER_TABLE",
            "target": "Sales.vIndividualCustomer.VIEW"
        },
        {
            "source": "dbo.uspPrintError.SQL_STORED_PROCEDURE",
            "target": "dbo.uspLogError.SQL_STORED_PROCEDURE"
        },
        {
            "source": "dbo.uspPrintError.SQL_STORED_PROCEDURE",
            "target": "Production.iWorkOrder.SQL_TRIGGER"
        },
        {
            "source": "dbo.uspPrintError.SQL_STORED_PROCEDURE",
            "target": "Production.uWorkOrder.SQL_TRIGGER"
        },
        {
            "source": "dbo.uspPrintError.SQL_STORED_PROCEDURE",
            "target": "Purchasing.dVendor.SQL_TRIGGER"
        },
        {
            "source": "dbo.uspPrintError.SQL_STORED_PROCEDURE",
            "target": "Purchasing.iPurchaseOrderDetail.SQL_TRIGGER"
        },
        {
            "source": "dbo.uspPrintError.SQL_STORED_PROCEDURE",
            "target": "Purchasing.uPurchaseOrderDetail.SQL_TRIGGER"
        },
        {
            "source": "dbo.uspPrintError.SQL_STORED_PROCEDURE",
            "target": "Purchasing.uPurchaseOrderHeader.SQL_TRIGGER"
        },
        {
            "source": "dbo.uspPrintError.SQL_STORED_PROCEDURE",
            "target": "Sales.iduSalesOrderDetail.SQL_TRIGGER"
        },
        {
            "source": "dbo.uspPrintError.SQL_STORED_PROCEDURE",
            "target": "Sales.uSalesOrderHeader.SQL_TRIGGER"
        },
        {
            "source": "HumanResources.Department.USER_TABLE",
            "target": "HumanResources.vEmployeeDepartment.VIEW"
        },
        {
            "source": "HumanResources.Department.USER_TABLE",
            "target": "HumanResources.vEmployeeDepartmentHistory.VIEW"
        },
        {
            "source": "HumanResources.Employee.USER_TABLE",
            "target": "dbo.ufnGetContactInformation.SQL_TABLE_VALUED_FUNCTION"
        },
        {
            "source": "HumanResources.Employee.USER_TABLE",
            "target": "dbo.uspGetEmployeeManagers.SQL_STORED_PROCEDURE"
        },
        {
            "source": "HumanResources.Employee.USER_TABLE",
            "target": "dbo.uspGetManagerEmployees.SQL_STORED_PROCEDURE"
        },
        {
            "source": "HumanResources.Employee.USER_TABLE",
            "target": "HumanResources.uspUpdateEmployeeHireInfo.SQL_STORED_PROCEDURE"
        },
        {
            "source": "HumanResources.Employee.USER_TABLE",
            "target": "HumanResources.uspUpdateEmployeeLogin.SQL_STORED_PROCEDURE"
        },
        {
            "source": "HumanResources.Employee.USER_TABLE",
            "target": "HumanResources.uspUpdateEmployeePersonalInfo.SQL_STORED_PROCEDURE"
        },
        {
            "source": "HumanResources.Employee.USER_TABLE",
            "target": "HumanResources.vEmployee.VIEW"
        },
        {
            "source": "HumanResources.Employee.USER_TABLE",
            "target": "HumanResources.vEmployeeDepartment.VIEW"
        },
        {
            "source": "HumanResources.Employee.USER_TABLE",
            "target": "HumanResources.vEmployeeDepartmentHistory.VIEW"
        },
        {
            "source": "HumanResources.Employee.USER_TABLE",
            "target": "Sales.vSalesPerson.VIEW"
        },
        {
            "source": "HumanResources.Employee.USER_TABLE",
            "target": "Sales.vSalesPersonSalesByFiscalYears.VIEW"
        },
        {
            "source": "HumanResources.EmployeeDepartmentHistory.USER_TABLE",
            "target": "HumanResources.vEmployeeDepartment.VIEW"
        },
        {
            "source": "HumanResources.EmployeeDepartmentHistory.USER_TABLE",
            "target": "HumanResources.vEmployeeDepartmentHistory.VIEW"
        },
        {
            "source": "HumanResources.EmployeePayHistory.USER_TABLE",
            "target": "HumanResources.uspUpdateEmployeeHireInfo.SQL_STORED_PROCEDURE"
        },
        {
            "source": "HumanResources.JobCandidate.USER_TABLE",
            "target": "HumanResources.vJobCandidate.VIEW"
        },
        {
            "source": "HumanResources.JobCandidate.USER_TABLE",
            "target": "HumanResources.vJobCandidateEducation.VIEW"
        },
        {
            "source": "HumanResources.JobCandidate.USER_TABLE",
            "target": "HumanResources.vJobCandidateEmployment.VIEW"
        },
        {
            "source": "HumanResources.Shift.USER_TABLE",
            "target": "HumanResources.vEmployeeDepartmentHistory.VIEW"
        },
        {
            "source": "Person.Address.USER_TABLE",
            "target": "HumanResources.vEmployee.VIEW"
        },
        {
            "source": "Person.Address.USER_TABLE",
            "target": "Purchasing.vVendorWithAddresses.VIEW"
        },
        {
            "source": "Person.Address.USER_TABLE",
            "target": "Sales.vIndividualCustomer.VIEW"
        },
        {
            "source": "Person.Address.USER_TABLE",
            "target": "Sales.vSalesPerson.VIEW"
        },
        {
            "source": "Person.Address.USER_TABLE",
            "target": "Sales.vStoreWithAddresses.VIEW"
        },
        {
            "source": "Person.AddressType.USER_TABLE",
            "target": "Purchasing.vVendorWithAddresses.VIEW"
        },
        {
            "source": "Person.AddressType.USER_TABLE",
            "target": "Sales.vIndividualCustomer.VIEW"
        },
        {
            "source": "Person.AddressType.USER_TABLE",
            "target": "Sales.vStoreWithAddresses.VIEW"
        },
        {
            "source": "Person.BusinessEntityAddress.USER_TABLE",
            "target": "HumanResources.vEmployee.VIEW"
        },
        {
            "source": "Person.BusinessEntityAddress.USER_TABLE",
            "target": "Purchasing.vVendorWithAddresses.VIEW"
        },
        {
            "source": "Person.BusinessEntityAddress.USER_TABLE",
            "target": "Sales.vIndividualCustomer.VIEW"
        },
        {
            "source": "Person.BusinessEntityAddress.USER_TABLE",
            "target": "Sales.vSalesPerson.VIEW"
        },
        {
            "source": "Person.BusinessEntityAddress.USER_TABLE",
            "target": "Sales.vStoreWithAddresses.VIEW"
        },
        {
            "source": "Person.BusinessEntityContact.USER_TABLE",
            "target": "dbo.ufnGetContactInformation.SQL_TABLE_VALUED_FUNCTION"
        },
        {
            "source": "Person.BusinessEntityContact.USER_TABLE",
            "target": "Purchasing.vVendorWithContacts.VIEW"
        },
        {
            "source": "Person.BusinessEntityContact.USER_TABLE",
            "target": "Sales.vStoreWithContacts.VIEW"
        },
        {
            "source": "Person.ContactType.USER_TABLE",
            "target": "dbo.ufnGetContactInformation.SQL_TABLE_VALUED_FUNCTION"
        },
        {
            "source": "Person.ContactType.USER_TABLE",
            "target": "Purchasing.vVendorWithContacts.VIEW"
        },
        {
            "source": "Person.ContactType.USER_TABLE",
            "target": "Sales.vStoreWithContacts.VIEW"
        },
        {
            "source": "Person.CountryRegion.USER_TABLE",
            "target": "HumanResources.vEmployee.VIEW"
        },
        {
            "source": "Person.CountryRegion.USER_TABLE",
            "target": "Person.vStateProvinceCountryRegion.VIEW"
        },
        {
            "source": "Person.CountryRegion.USER_TABLE",
            "target": "Purchasing.vVendorWithAddresses.VIEW"
        },
        {
            "source": "Person.CountryRegion.USER_TABLE",
            "target": "Sales.vIndividualCustomer.VIEW"
        },
        {
            "source": "Person.CountryRegion.USER_TABLE",
            "target": "Sales.vSalesPerson.VIEW"
        },
        {
            "source": "Person.CountryRegion.USER_TABLE",
            "target": "Sales.vStoreWithAddresses.VIEW"
        },
        {
            "source": "Person.EmailAddress.USER_TABLE",
            "target": "HumanResources.vEmployee.VIEW"
        },
        {
            "source": "Person.EmailAddress.USER_TABLE",
            "target": "Purchasing.vVendorWithContacts.VIEW"
        },
        {
            "source": "Person.EmailAddress.USER_TABLE",
            "target": "Sales.vIndividualCustomer.VIEW"
        },
        {
            "source": "Person.EmailAddress.USER_TABLE",
            "target": "Sales.vSalesPerson.VIEW"
        },
        {
            "source": "Person.EmailAddress.USER_TABLE",
            "target": "Sales.vStoreWithContacts.VIEW"
        },
        {
            "source": "Person.Person.USER_TABLE",
            "target": "dbo.ufnGetContactInformation.SQL_TABLE_VALUED_FUNCTION"
        },
        {
            "source": "Person.Person.USER_TABLE",
            "target": "dbo.uspGetEmployeeManagers.SQL_STORED_PROCEDURE"
        },
        {
            "source": "Person.Person.USER_TABLE",
            "target": "dbo.uspGetManagerEmployees.SQL_STORED_PROCEDURE"
        },
        {
            "source": "Person.Person.USER_TABLE",
            "target": "HumanResources.vEmployee.VIEW"
        },
        {
            "source": "Person.Person.USER_TABLE",
            "target": "HumanResources.vEmployeeDepartment.VIEW"
        },
        {
            "source": "Person.Person.USER_TABLE",
            "target": "HumanResources.vEmployeeDepartmentHistory.VIEW"
        },
        {
            "source": "Person.Person.USER_TABLE",
            "target": "Person.iuPerson.SQL_TRIGGER"
        },
        {
            "source": "Person.Person.USER_TABLE",
            "target": "Person.vAdditionalContactInfo.VIEW"
        },
        {
            "source": "Person.Person.USER_TABLE",
            "target": "Purchasing.vVendorWithContacts.VIEW"
        },
        {
            "source": "Person.Person.USER_TABLE",
            "target": "Sales.iduSalesOrderDetail.SQL_TRIGGER"
        },
        {
            "source": "Person.Person.USER_TABLE",
            "target": "Sales.vIndividualCustomer.VIEW"
        },
        {
            "source": "Person.Person.USER_TABLE",
            "target": "Sales.vPersonDemographics.VIEW"
        },
        {
            "source": "Person.Person.USER_TABLE",
            "target": "Sales.vSalesPerson.VIEW"
        },
        {
            "source": "Person.Person.USER_TABLE",
            "target": "Sales.vSalesPersonSalesByFiscalYears.VIEW"
        },
        {
            "source": "Person.Person.USER_TABLE",
            "target": "Sales.vStoreWithContacts.VIEW"
        },
        {
            "source": "Person.PersonPhone.USER_TABLE",
            "target": "HumanResources.vEmployee.VIEW"
        },
        {
            "source": "Person.PersonPhone.USER_TABLE",
            "target": "Purchasing.vVendorWithContacts.VIEW"
        },
        {
            "source": "Person.PersonPhone.USER_TABLE",
            "target": "Sales.vIndividualCustomer.VIEW"
        },
        {
            "source": "Person.PersonPhone.USER_TABLE",
            "target": "Sales.vSalesPerson.VIEW"
        },
        {
            "source": "Person.PersonPhone.USER_TABLE",
            "target": "Sales.vStoreWithContacts.VIEW"
        },
        {
            "source": "Person.PhoneNumberType.USER_TABLE",
            "target": "HumanResources.vEmployee.VIEW"
        },
        {
            "source": "Person.PhoneNumberType.USER_TABLE",
            "target": "Purchasing.vVendorWithContacts.VIEW"
        },
        {
            "source": "Person.PhoneNumberType.USER_TABLE",
            "target": "Sales.vIndividualCustomer.VIEW"
        },
        {
            "source": "Person.PhoneNumberType.USER_TABLE",
            "target": "Sales.vSalesPerson.VIEW"
        },
        {
            "source": "Person.PhoneNumberType.USER_TABLE",
            "target": "Sales.vStoreWithContacts.VIEW"
        },
        {
            "source": "Person.StateProvince.USER_TABLE",
            "target": "HumanResources.vEmployee.VIEW"
        },
        {
            "source": "Person.StateProvince.USER_TABLE",
            "target": "Person.vStateProvinceCountryRegion.VIEW"
        },
        {
            "source": "Person.StateProvince.USER_TABLE",
            "target": "Purchasing.vVendorWithAddresses.VIEW"
        },
        {
            "source": "Person.StateProvince.USER_TABLE",
            "target": "Sales.vIndividualCustomer.VIEW"
        },
        {
            "source": "Person.StateProvince.USER_TABLE",
            "target": "Sales.vSalesPerson.VIEW"
        },
        {
            "source": "Person.StateProvince.USER_TABLE",
            "target": "Sales.vStoreWithAddresses.VIEW"
        },
        {
            "source": "Production.BillOfMaterials.USER_TABLE",
            "target": "dbo.uspGetBillOfMaterials.SQL_STORED_PROCEDURE"
        },
        {
            "source": "Production.BillOfMaterials.USER_TABLE",
            "target": "dbo.uspGetWhereUsedProductID.SQL_STORED_PROCEDURE"
        },
        {
            "source": "Production.Product.USER_TABLE",
            "target": "dbo.ufnGetProductDealerPrice.SQL_SCALAR_FUNCTION"
        },
        {
            "source": "Production.Product.USER_TABLE",
            "target": "dbo.ufnGetProductListPrice.SQL_SCALAR_FUNCTION"
        },
        {
            "source": "Production.Product.USER_TABLE",
            "target": "dbo.ufnGetProductStandardCost.SQL_SCALAR_FUNCTION"
        },
        {
            "source": "Production.Product.USER_TABLE",
            "target": "dbo.uspGetBillOfMaterials.SQL_STORED_PROCEDURE"
        },
        {
            "source": "Production.Product.USER_TABLE",
            "target": "dbo.uspGetWhereUsedProductID.SQL_STORED_PROCEDURE"
        },
        {
            "source": "Production.Product.USER_TABLE",
            "target": "Production.vProductAndDescription.VIEW"
        },
        {
            "source": "Production.ProductCostHistory.USER_TABLE",
            "target": "dbo.ufnGetProductStandardCost.SQL_SCALAR_FUNCTION"
        },
        {
            "source": "Production.ProductDescription.USER_TABLE",
            "target": "Production.vProductAndDescription.VIEW"
        },
        {
            "source": "Production.ProductInventory.USER_TABLE",
            "target": "dbo.ufnGetStock.SQL_SCALAR_FUNCTION"
        },
        {
            "source": "Production.ProductListPriceHistory.USER_TABLE",
            "target": "dbo.ufnGetProductDealerPrice.SQL_SCALAR_FUNCTION"
        },
        {
            "source": "Production.ProductListPriceHistory.USER_TABLE",
            "target": "dbo.ufnGetProductListPrice.SQL_SCALAR_FUNCTION"
        },
        {
            "source": "Production.ProductModel.USER_TABLE",
            "target": "Production.vProductAndDescription.VIEW"
        },
        {
            "source": "Production.ProductModel.USER_TABLE",
            "target": "Production.vProductModelCatalogDescription.VIEW"
        },
        {
            "source": "Production.ProductModel.USER_TABLE",
            "target": "Production.vProductModelInstructions.VIEW"
        },
        {
            "source": "Production.ProductModelProductDescriptionCulture.USER_TABLE",
            "target": "Production.vProductAndDescription.VIEW"
        },
        {
            "source": "Production.TransactionHistory.USER_TABLE",
            "target": "Production.iWorkOrder.SQL_TRIGGER"
        },
        {
            "source": "Production.TransactionHistory.USER_TABLE",
            "target": "Production.uWorkOrder.SQL_TRIGGER"
        },
        {
            "source": "Production.TransactionHistory.USER_TABLE",
            "target": "Purchasing.iPurchaseOrderDetail.SQL_TRIGGER"
        },
        {
            "source": "Production.TransactionHistory.USER_TABLE",
            "target": "Purchasing.uPurchaseOrderDetail.SQL_TRIGGER"
        },
        {
            "source": "Production.TransactionHistory.USER_TABLE",
            "target": "Sales.iduSalesOrderDetail.SQL_TRIGGER"
        },
        {
            "source": "Purchasing.PurchaseOrderDetail.USER_TABLE",
            "target": "Purchasing.iPurchaseOrderDetail.SQL_TRIGGER"
        },
        {
            "source": "Purchasing.PurchaseOrderDetail.USER_TABLE",
            "target": "Purchasing.uPurchaseOrderDetail.SQL_TRIGGER"
        },
        {
            "source": "Purchasing.PurchaseOrderHeader.USER_TABLE",
            "target": "Purchasing.iPurchaseOrderDetail.SQL_TRIGGER"
        },
        {
            "source": "Purchasing.PurchaseOrderHeader.USER_TABLE",
            "target": "Purchasing.uPurchaseOrderDetail.SQL_TRIGGER"
        },
        {
            "source": "Purchasing.PurchaseOrderHeader.USER_TABLE",
            "target": "Purchasing.uPurchaseOrderHeader.SQL_TRIGGER"
        },
        {
            "source": "Purchasing.Vendor.USER_TABLE",
            "target": "dbo.ufnGetContactInformation.SQL_TABLE_VALUED_FUNCTION"
        },
        {
            "source": "Purchasing.Vendor.USER_TABLE",
            "target": "Purchasing.vVendorWithAddresses.VIEW"
        },
        {
            "source": "Purchasing.Vendor.USER_TABLE",
            "target": "Purchasing.vVendorWithContacts.VIEW"
        },
        {
            "source": "Sales.SalesOrderDetail.USER_TABLE",
            "target": "Sales.iduSalesOrderDetail.SQL_TRIGGER"
        },
        {
            "source": "Sales.SalesOrderHeader.USER_TABLE",
            "target": "Sales.iduSalesOrderDetail.SQL_TRIGGER"
        },
        {
            "source": "Sales.SalesOrderHeader.USER_TABLE",
            "target": "Sales.uSalesOrderHeader.SQL_TRIGGER"
        },
        {
            "source": "Sales.SalesOrderHeader.USER_TABLE",
            "target": "Sales.vSalesPersonSalesByFiscalYears.VIEW"
        },
        {
            "source": "Sales.SalesPerson.USER_TABLE",
            "target": "Sales.uSalesOrderHeader.SQL_TRIGGER"
        },
        {
            "source": "Sales.SalesPerson.USER_TABLE",
            "target": "Sales.vSalesPerson.VIEW"
        },
        {
            "source": "Sales.SalesPerson.USER_TABLE",
            "target": "Sales.vSalesPersonSalesByFiscalYears.VIEW"
        },
        {
            "source": "Sales.SalesTerritory.USER_TABLE",
            "target": "Sales.uSalesOrderHeader.SQL_TRIGGER"
        },
        {
            "source": "Sales.SalesTerritory.USER_TABLE",
            "target": "Sales.vSalesPerson.VIEW"
        },
        {
            "source": "Sales.SalesTerritory.USER_TABLE",
            "target": "Sales.vSalesPersonSalesByFiscalYears.VIEW"
        },
        {
            "source": "Sales.Store.USER_TABLE",
            "target": "dbo.ufnGetContactInformation.SQL_TABLE_VALUED_FUNCTION"
        },
        {
            "source": "Sales.Store.USER_TABLE",
            "target": "Sales.vStoreWithAddresses.VIEW"
        },
        {
            "source": "Sales.Store.USER_TABLE",
            "target": "Sales.vStoreWithContacts.VIEW"
        },
        {
            "source": "Sales.Store.USER_TABLE",
            "target": "Sales.vStoreWithDemographics.VIEW"
        }
    ]
}

        const svg = d3.select("#graph"),
            width = +svg.attr("width"),
            height = +svg.attr("height");

        const simulation = d3.forceSimulation()
            .force("link", d3.forceLink().id(d => d.id).distance(100))
            .force("charge", d3.forceManyBody().strength(-300))
            .force("center", d3.forceCenter(width / 2, height / 2));

        const graphGroup = svg.append("g");

        // Add zoom and pan
        svg.call(d3.zoom().on("zoom", (event) => {
            graphGroup.attr("transform", event.transform);
        }));

        const links = graphGroup.selectAll(".link")
            .data(graphData.edges)
            .enter().append("line")
            .attr("class", "link")
            .attr("stroke", "#999")
            .attr("stroke-width", 2);

        const nodes = graphGroup.selectAll(".node")
            .data(graphData.nodes)
            .enter().append("g")
            .attr("class", "node")
            .call(d3.drag()
                .on("start", dragStarted)
                .on("drag", dragged)
                .on("end", dragEnded));

        nodes.append("rect")
            .attr("width", 80)
            .attr("height", 40)
            .attr("rx", 5)
            .attr("fill", "#2196F3")
            .attr("stroke", "white")
            .attr("stroke-width", 2);

        nodes.append("text")
            .attr("x", 40)
            .attr("y", 25)
            .attr("text-anchor", "middle")
            .attr("fill", "white")
            .attr("font-size", "10px")
            .text(d => d.object_name);

        simulation
            .nodes(graphData.nodes)
            .on("tick", ticked);

        simulation.force("link")
            .links(graphData.edges);

        function ticked() {
            links
                .attr("x1", d => d.source.x)
                .attr("y1", d => d.source.y)
                .attr("x2", d => d.target.x)
                .attr("y2", d => d.target.y);

            nodes
                .attr("transform", d => `translate(${d.x},${d.y})`);
        }

        function dragStarted(event, d) {
            if (!event.active) simulation.alphaTarget(0.3).restart();
            d.fx = d.x;
            d.fy = d.y;
        }

        function dragged(event, d) {
            d.fx = event.x;
            d.fy = event.y;
        }

        function dragEnded(event, d) {
            if (!event.active) simulation.alphaTarget(0);
            d.fx = null;
            d.fy = null;
        }

        // Add filtering functionality
        const levelSelect = d3.select("#level-select");
        const clusterSelect = d3.select("#cluster-select");

        const levels = Array.from(new Set(graphData.nodes.map(d => d.level)));
        const clusters = Array.from(new Set(graphData.nodes.map(d => d.cluster)));

        levels.forEach(level => {
            levelSelect.append("option")
                .attr("value", level)
                .text(`Level ${level}`);
        });

        clusters.forEach(cluster => {
            clusterSelect.append("option")
                .attr("value", cluster)
                .text(`Cluster ${cluster}`);
        });

        const applyFilters = () => {
            const selectedLevel = levelSelect.node().value;
            const selectedCluster = clusterSelect.node().value;

            nodes.style("display", d => {
                const levelMatch = !selectedLevel || d.level == selectedLevel;
                const clusterMatch = !selectedCluster || d.cluster == selectedCluster;
                return levelMatch && clusterMatch ? "block" : "none";
            });

            links.style("display", d => {
                const sourceVisible = nodes.filter(n => n.id === d.source.id).style("display") !== "none";
                const targetVisible = nodes.filter(n => n.id === d.target.id).style("display") !== "none";
                return sourceVisible && targetVisible ? "block" : "none";
            });
        };

        levelSelect.on("change", applyFilters);
        clusterSelect.on("change", applyFilters);

        d3.select("#reset-filters").on("click", () => {
            levelSelect.node().value = "";
            clusterSelect.node().value = "";
            applyFilters();
        });
    </script>
</body>
</html>
